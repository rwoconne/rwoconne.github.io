<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML EXPERIMENTAL 970324//EN">
<HTML>
<STYLE><!--
H1         { font-family: Stone Sans, Helvetica, Arial, sans-serif }
H1.Chapter-Name    { font-size: 36pt }
H2         { font-family: Stone Sans, Helvetica, Arial, sans-serif }
H3         { font-family: Stone Sans, Helvetica, Arial, sans-serif }
H4         { font-family: Stone Sans, Helvetica, Arial, sans-serif }
H5         { font-family: Stone Sans, Helvetica, Arial, sans-serif ;
             margin-top: -5.0pt ; font-size: 12pt }
H6         { font-family: Stone Sans, Helvetica, Arial, sans-serif ;
             margin-top: -5.0pt ; font-size: 12pt }
P          { font-family: Minion, Times, serif }
P.api      { font-family: Courier ; font-weight: Bold }
P.Code     { font-family: Courier, serif ; font-size: 10pt}
P.Code-2   { font-family: Courier, serif ; font-size: 10pt}
P.Code-Result   { font-family: Courier, serif ; font-size: 10pt ;
                  font-weight: Bold}
P.ChapTOC  { font-family: Stone Sans, Helvetica, Arial, sans-serif }
P.Chapter-NameTOC   { font-family: Stone Sans, Helvetica, Arial, sans-serif ;
		      font-size: 20pt; font-weight: Bold }
P.Level2IX	{margin-left: 10pt }
LI.Code-Numbered     { font-family: Courier, serif ; font-size: 10pt}
LI.Code-Numbered-1   { font-family: Courier, serif ; font-size: 10pt}
--></STYLE>

<HEAD>
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter">

<TITLE> POLY_2D</TITLE></HEAD>
<BODY BGCOLOR="#ffffff">
<DIV>
<DIV><table width="100%" border=0 cellspacing=0 cellpadding=0> <TR>  <TD></TD>   <TD  bgcolor="#ffffff">     <IMG SRC = "idlmap.gif" USEMAP = "#idlmap.gif" BORDER = 0>   </TD> </TR></TABLE><MAP NAME = "idlmap.gif"><AREA SHAPE=RECT HREF="idl140.htm" COORDS="290, 29, 344, 43"><AREA SHAPE=RECT HREF="idl.htm" COORDS="139, 29, 239, 46"><AREA SHAPE=RECT HREF="idl13e.htm" COORDS="0, 29, 98, 46"><AREA SHAPE=RECT HREF="idl.htm" COORDS="68, 0, 275, 18"></MAP></DIV><HR></DIV>
<H2 CLASS="Routine-Name">
<A NAME="pgfId=678200">
 </A>
<A NAME="17887">
 </A>
POLY_2D</H2>
<P CLASS="Body">
<A NAME="pgfId=807275">
 </A>
The <A NAME="marker=673572">
 </A>
POLY_2D function performs <A NAME="marker=673573">
 </A>
polynomial <A NAME="marker=673574">
 </A>
warping of <A NAME="marker=673575">
 </A>
images. This function performs a geometrical transformation in which the resulting array is defined by:</P>
<P CLASS="Body---centered">
<A NAME="pgfId=797908">
 </A>
<EM CLASS="Emphasis">
g [x, y] = f [x', y'] = f [a [x, y], b [x, y]]</EM>
</P>
<P CLASS="Body">
<A NAME="pgfId=815305">
 </A>
where <I CLASS="Italic">
g</I>
[<I CLASS="Italic">
x</I>
, <I CLASS="Italic">
y</I>
] represents the pixel in the output image at coordinate (<I CLASS="Italic">
x</I>
, <I CLASS="Italic">
y</I>
), and <EM CLASS="Emphasis">
f</EM>
&nbsp;[<EM CLASS="Emphasis">
x</EM>
',&nbsp;<EM CLASS="Emphasis">
y</EM>
'] is the pixel at (<EM CLASS="Emphasis">
x</EM>
',&nbsp;<EM CLASS="Emphasis">
y</EM>
') in the input image that is used to derive <I CLASS="Italic">
g</I>
[<I CLASS="Italic">
x</I>
, <I CLASS="Italic">
y</I>
]. The functions <I CLASS="Italic">
a&nbsp;</I>
(<I CLASS="Italic">
x</I>
, <I CLASS="Italic">
y</I>
) and <I CLASS="Italic">
b</I>
&nbsp;(<I CLASS="Italic">
x</I>
, <I CLASS="Italic">
y</I>
) are polynomials in <I CLASS="Italic">
x</I>
 and <I CLASS="Italic">
y</I>
 of degree <I CLASS="Italic">
N</I>
, whose coefficients are given by <I CLASS="Italic">
P</I>
 and <I CLASS="Italic">
Q</I>
, and specify the spatial transformation:</P>
<DIV>
<CENTER><IMG SRC="idl_76.gif" BORDER=0>
</DIV>
<P CLASS="Body">
<A NAME="pgfId=835081">
 </A>
Either the nearest neighbor or bilinear interpolation methods can be selected.</P>
<DIV>
<H3 CLASS="Heading-1R">
<A NAME="pgfId=678203">
 </A>
Calling Sequence</H3>
<P CLASS="Body">
<A NAME="pgfId=678204">
 </A>
Result = POLY_2D(<I CLASS="Italic">
Array, P, Q [, Interp [, Dim</I>
<SUB CLASS="Subscript">
x</SUB>
<I CLASS="Italic">
, Dim</I>
<SUB CLASS="Subscript">
y</SUB>
<I CLASS="Italic">
]]</I>
)</P>
</DIV>
<DIV>
<H3 CLASS="Heading-1R">
<A NAME="pgfId=678205">
 </A>
Arguments</H3>
<DIV>
<H4 CLASS="Argument">
<A NAME="pgfId=678206">
 </A>
Array</H4>
<P CLASS="Body">
<A NAME="pgfId=678207">
 </A>
A two-dimensional array of any basic type except string. The result has the same type as <I CLASS="Italic">
Array</I>
.</P>
</DIV>
<DIV>
<H4 CLASS="Argument">
<A NAME="pgfId=678208">
 </A>
P and Q</H4>
<P CLASS="Body">
<A NAME="pgfId=678209">
 </A>
<I CLASS="Italic">
P</I>
 and <I CLASS="Italic">
Q</I>
 are arrays containing the polynomial coefficients. Each array must contain (<I CLASS="Italic">
N</I>
+1)<SUP CLASS="Superscript">
2</SUP>
 elements (where <I CLASS="Italic">
N</I>
 is the degree of the polynomial). For example, for a linear transformation, <I CLASS="Italic">
P</I>
 and <I CLASS="Italic">
Q</I>
 contain four elements and can be a 2 x 2 array or a 4-element vector. <I CLASS="Italic">
P</I>
<SUB CLASS="Subscript">
i,j</SUB>
 contains the coefficient used to determine <I CLASS="Italic">
x'</I>
, and is the weight of the term <I CLASS="Italic">
x</I>
<SUP CLASS="Superscript">
j</SUP>
<I CLASS="Italic">
y</I>
<SUP CLASS="Superscript">
i</SUP>
. The POLYWARP procedure can be used to fit <I CLASS="Italic">
(x', y')</I>
 as a function of <I CLASS="Italic">
(x, y)</I>
 and determines the coefficient arrays <I CLASS="Italic">
P</I>
 and <I CLASS="Italic">
Q</I>
.</P>
</DIV>
<DIV>
<H4 CLASS="Argument">
<A NAME="pgfId=678210">
 </A>
Interp</H4>
<P CLASS="Body">
<A NAME="pgfId=678211">
 </A>
Set this argument to a 1to perform bilinear interpolation. Set this argument to 2 to perform cubic convolution interpolation (as described under the CUBIC keyword, below). Otherwise, the nearest neighbor method is used. For the linear case, (<I CLASS="Italic">
N</I>
=1), bilinear interpolation requires approximately twice as much time as does the nearest neighbor method. </P>
</DIV>
<DIV>
<H4 CLASS="Argument">
<A NAME="pgfId=678212">
 </A>
Dim<SUB CLASS="Subscript">
x</SUB>
</H4>
<P CLASS="Body">
<A NAME="pgfId=678213">
 </A>
If present, <I CLASS="Italic">
Dim</I>
<SUB CLASS="Subscript">
x</SUB>
 specifies the number of columns in the output. If omitted, the output has the same number of columns as <I CLASS="Italic">
Array</I>
.</P>
</DIV>
<DIV>
<H4 CLASS="Argument">
<A NAME="pgfId=678214">
 </A>
Dim<SUB CLASS="Subscript">
y</SUB>
</H4>
<P CLASS="Body">
<A NAME="pgfId=678215">
 </A>
If present, <I CLASS="Italic">
Dim</I>
<SUB CLASS="Subscript">
y</SUB>
 specifies the number of rows in the output. If omitted, the output has the same number of rows as <I CLASS="Italic">
Array</I>
.</P>
</DIV>
</DIV>
<DIV>
<H3 CLASS="Heading-1R">
<A NAME="pgfId=678216">
 </A>
Keywords</H3>
<DIV>
<H4 CLASS="Argument">
<A NAME="pgfId=678217">
 </A>
<A NAME="marker=675255">
 </A>
CUBIC</H4>
<P CLASS="Body">
<A NAME="pgfId=843506">
 </A>
Set this keyword to a value between -1 and 0 to use the cubic convolution interpolation method with the specified value as the interpolation parameter. Setting this keyword equal to a value greater than zero specifies a value of -1 for the interpolation parameter. Park and Schowengerdt (see reference below) suggest that a value of -0.5 significantly improves the reconstruction properties of this algorithm. Note that cubic convolution interpolation works only with one- and two-dimensional arrays.</P>
<P CLASS="Body">
<A NAME="pgfId=843519">
 </A>
Cubic convolution is an interpolation method that closely approximates the theoretically optimum sinc interpolation function using cubic polynomials. According to sampling theory, details of which are beyond the scope of this document, if the original signal, <I CLASS="Italic">
f</I>
, is a band-limited signal, with no frequency component larger than <EM CLASS="Symbol">
w</EM>
<SUB CLASS="Subscript">
0</SUB>
, and <I CLASS="Italic">
f</I>
 is sampled with spacing less than or equal to 1/2<EM CLASS="Symbol">
w</EM>
<SUB CLASS="Subscript">
0</SUB>
, then <I CLASS="Italic">
f</I>
 can be reconstructed by convolving with a sinc function: sinc&nbsp;(<EM CLASS="Emphasis">
x</EM>
)&nbsp;=&nbsp;sin (<EM CLASS="Symbol">
p</EM>
<EM CLASS="Emphasis">
x</EM>
) / (<EM CLASS="Symbol">
p</EM>
<EM CLASS="Emphasis">
x</EM>
).</P>
<P CLASS="Body">
<A NAME="pgfId=843508">
 </A>
In the one-dimensional case, four neighboring points are used, while in the two-dimensional case 16 points are used. Note that cubic convolution interpolation is significantly slower than bilinear interpolation.</P>
<P CLASS="Body">
<A NAME="pgfId=843509">
 </A>
For further details see:</P>
<P CLASS="Body">
<A NAME="pgfId=843510">
 </A>
Rifman, S.S. and McKinnon, D.M., &quot;Evaluation of Digital Correction Techniques for ERTS Images; Final Report&quot;, Report 20634-6003-TU-00, TRW Systems, Redondo Beach, CA, July 1974.</P>
<P CLASS="Body">
<A NAME="pgfId=843511">
 </A>
S. Park and R. Schowengerdt, 1983 &quot;Image Reconstruction by Parametric Cubic Convolution&quot;, Computer Vision, Graphics &amp; Image Processing 23, 256.</P>
</DIV>
<DIV>
<H4 CLASS="Argument">
<A NAME="pgfId=680892">
 </A>
<A NAME="marker=673587">
 </A>
MISSING</H4>
<P CLASS="Body">
<A NAME="pgfId=678218">
 </A>
Specifies the output value for points whose <I CLASS="Italic">
x', y'</I>
 is outside the bounds of <I CLASS="Italic">
Array</I>
. If <A NAME="marker=788500">
 </A>
MISSING is not specified, the resulting output value is extrapolated from the nearest pixel of <I CLASS="Italic">
Array</I>
.</P>
</DIV>
</DIV>
<DIV>
<H3 CLASS="Heading-1R">
<A NAME="pgfId=678219">
 </A>
Example</H3>
<P CLASS="Body">
<A NAME="pgfId=807460">
 </A>
Some simple linear (degree one) transformations are:</P>
<CENTER><TABLE BORDER="1">
<CAPTION>
<UL>
<LI CLASS="Table">
<A NAME="pgfId=807443">
 </A>
Simple Transformations for Use with POLY_2D</LI>
</UL>
<TR>
<TH ROWSPAN="1" COLSPAN="1">
<P CLASS="CellHeading">
<A NAME="pgfId=807335">
 </A>
P<SUB CLASS="Subscript">
0,0</SUB>
&middot;</P>
</TH>
<TH ROWSPAN="1" COLSPAN="1">
<P CLASS="CellHeading">
<A NAME="pgfId=807337">
 </A>
P<SUB CLASS="Subscript">
1,0</SUB>
&middot;</P>
</TH>
<TH ROWSPAN="1" COLSPAN="1">
<P CLASS="CellHeading">
<A NAME="pgfId=807339">
 </A>
P<SUB CLASS="Subscript">
0,1</SUB>
&middot;</P>
</TH>
<TH ROWSPAN="1" COLSPAN="1">
<P CLASS="CellHeading">
<A NAME="pgfId=807341">
 </A>
P<SUB CLASS="Subscript">
1,1</SUB>
&middot;</P>
</TH>
<TH ROWSPAN="1" COLSPAN="1">
<P CLASS="CellHeading">
<A NAME="pgfId=807343">
 </A>
Q<SUB CLASS="Subscript">
0,0</SUB>
&middot;</P>
</TH>
<TH ROWSPAN="1" COLSPAN="1">
<P CLASS="CellHeading">
<A NAME="pgfId=807345">
 </A>
Q<SUB CLASS="Subscript">
1,0</SUB>
&middot;</P>
</TH>
<TH ROWSPAN="1" COLSPAN="1">
<P CLASS="CellHeading">
<A NAME="pgfId=807347">
 </A>
Q<SUB CLASS="Subscript">
0,1</SUB>
&middot;</P>
</TH>
<TH ROWSPAN="1" COLSPAN="1">
<P CLASS="CellHeading">
<A NAME="pgfId=807349">
 </A>
Q<SUB CLASS="Subscript">
1,1</SUB>
&middot;</P>
</TH>
<TH ROWSPAN="1" COLSPAN="1">
<P CLASS="CellHeading">
<A NAME="pgfId=807351">
 </A>
Effect</P>
</TH>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807353">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807355">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807357">
 </A>
1</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807359">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807361">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807363">
 </A>
1</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807365">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807367">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807369">
 </A>
Identity</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807371">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807373">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807375">
 </A>
0.5</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807377">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807379">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807381">
 </A>
1</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807383">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807385">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807387">
 </A>
Stretch X by a factor of 2</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807389">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807391">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807393">
 </A>
1</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807395">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807397">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807399">
 </A>
2.0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807401">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807403">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807405">
 </A>
Shrink Y by a factor of 2</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807407">
 </A>
z</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807409">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807411">
 </A>
1</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807413">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807415">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807417">
 </A>
1</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807419">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807421">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807423">
 </A>
Shift left by z pixels</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807425">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807427">
 </A>
1</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807429">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807431">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807433">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807435">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807437">
 </A>
1</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807439">
 </A>
0</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId=807441">
 </A>
Transpose</P>
</TD>
</TR>
</CAPTION>
</TABLE></CENTER>
<P CLASS="Body">
<A NAME="pgfId=678220">
 </A>
POLY_2D is often used in conjunction with the POLYWARP procedure to warp images. Create and display a simple image by entering:</P>
<P CLASS="Code">
<A NAME="pgfId=678221">
 </A>
A = BYTSCL(SIN(DIST(250)), TOP=!D.TABLE_SIZE) &amp; TV, A</P>
<P CLASS="Body">
<A NAME="pgfId=678222">
 </A>
Set up the arrays of original points to be warped by entering:</P>
<P CLASS="Code">
<A NAME="pgfId=678223">
 </A>
XO = [61, 62, 143, 133]</P>
<P CLASS="Code">
<A NAME="pgfId=678224">
 </A>
YO = [89, 34, 38, 105]</P>
<P CLASS="Body">
<A NAME="pgfId=678225">
 </A>
Set up the arrays of points to be fit by entering:</P>
<P CLASS="Code">
<A NAME="pgfId=678226">
 </A>
XI = [24, 35, 102, 92]</P>
<P CLASS="Code">
<A NAME="pgfId=678227">
 </A>
YI = [81, 24, 25, 92]</P>
<P CLASS="Body">
<A NAME="pgfId=678228">
 </A>
Use POLYWARP to generate the P and Q inputs to POLY_2D by entering:</P>
<P CLASS="Code">
<A NAME="pgfId=678229">
 </A>
POLYWARP, XI, YI, XO, YO, 1, P, Q</P>
<P CLASS="Body">
<A NAME="pgfId=678230">
 </A>
To perform an image warping based on P and Q, enter:</P>
<P CLASS="Code">
<A NAME="pgfId=678231">
 </A>
B = POLY_2D(A, P, Q)</P>
<P CLASS="Body">
<A NAME="pgfId=678232">
 </A>
Display the new image by entering:</P>
<P CLASS="Body">
<A NAME="pgfId=678233">
 </A>
TV, B, 250, 250</P>
<P CLASS="Body">
<A NAME="pgfId=678235">
 </A>
Images can also be warped over irregularly gridded control points using the WARP_TRI procedure.</P>
</DIV>
<DIV>
<H3 CLASS="Heading-1R">
<A NAME="pgfId=821499">
 </A>
See Also</H3>
<P CLASS="Body">
<A NAME="pgfId=821500">
 </A>
<A HREF="idl146.htm#37175" CLASS="XRef">
POLYWARP</A>
</P>
</DIV>
</BODY>
</HTML>
