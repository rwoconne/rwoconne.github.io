<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML EXPERIMENTAL 970324//EN">
<HTML>
<STYLE><!--
H1         { font-family: Stone Sans, Helvetica, Arial, sans-serif }
H1.Chapter-Name    { font-size: 36pt }
H2         { font-family: Stone Sans, Helvetica, Arial, sans-serif }
H3         { font-family: Stone Sans, Helvetica, Arial, sans-serif }
H4         { font-family: Stone Sans, Helvetica, Arial, sans-serif }
H5         { font-family: Stone Sans, Helvetica, Arial, sans-serif ;
             margin-top: -5.0pt ; font-size: 12pt }
H6         { font-family: Stone Sans, Helvetica, Arial, sans-serif ;
             margin-top: -5.0pt ; font-size: 12pt }
P          { font-family: Minion, Times, serif }
P.api      { font-family: Courier ; font-weight: Bold }
P.Code     { font-family: Courier, serif ; font-size: 10pt}
P.Code-2   { font-family: Courier, serif ; font-size: 10pt}
P.Code-Result   { font-family: Courier, serif ; font-size: 10pt ;
                  font-weight: Bold}
P.ChapTOC  { font-family: Stone Sans, Helvetica, Arial, sans-serif }
P.Chapter-NameTOC   { font-family: Stone Sans, Helvetica, Arial, sans-serif ;
		      font-size: 20pt; font-weight: Bold }
P.Level2IX	{margin-left: 10pt }
LI.Code-Numbered     { font-family: Courier, serif ; font-size: 10pt}
LI.Code-Numbered-1   { font-family: Courier, serif ; font-size: 10pt}
--></STYLE>

<HEAD>
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter">

<TITLE> QROMB</TITLE></HEAD>
<BODY BGCOLOR="#ffffff">
<DIV>
<DIV><table width="100%" border=0 cellspacing=0 cellpadding=0> <TR>  <TD></TD>   <TD  bgcolor="#ffffff">     <IMG SRC = "idlmap.gif" USEMAP = "#idlmap.gif" BORDER = 0>   </TD> </TR></TABLE><MAP NAME = "idlmap.gif"><AREA SHAPE=RECT HREF="idl159.htm" COORDS="290, 29, 344, 43"><AREA SHAPE=RECT HREF="idl.htm" COORDS="139, 29, 239, 46"><AREA SHAPE=RECT HREF="idl157.htm" COORDS="0, 29, 98, 46"><AREA SHAPE=RECT HREF="idl.htm" COORDS="68, 0, 275, 18"></MAP></DIV><HR></DIV>
<H2 CLASS="Routine-Name">
<A NAME="pgfId=51508">
 </A>
<A NAME="72956">
 </A>
QROMB</H2>
<P CLASS="Body">
<A NAME="pgfId=51512">
 </A>
The <A NAME="marker=51510">
 </A>
QROMB <A NAME="marker=51511">
 </A>
function evaluates the integral of a function over the closed interval [<I CLASS="Italic">
A, B</I>
] using <A NAME="marker=51513">
 </A>
Romberg integration. The result will have the same structure as the smaller of <I CLASS="Italic">
A</I>
 and <I CLASS="Italic">
B</I>
, and the resulting type will be single- or double-precision floating, depending on the input types.</P>
<P CLASS="Body">
<A NAME="pgfId=51514">
 </A>
QROMB is based on the routine <CODE CLASS="Code">
qromb</CODE>
 described in section 4.3 of <I CLASS="Italic">
Numerical Recipes in C: The Art of Scientific Computing</I>
 (Second Edition), published by Cambridge University Press, and is used by permission.</P>
<DIV>
<H3 CLASS="Heading-1R">
<A NAME="pgfId=51515">
 </A>
Calling Sequence</H3>
<P CLASS="Body">
<A NAME="pgfId=51516">
 </A>
Result = QROMB(<I CLASS="Italic">
Func, A, B</I>
)</P>
</DIV>
<DIV>
<H3 CLASS="Heading-1R">
<A NAME="pgfId=51517">
 </A>
Arguments</H3>
<DIV>
<H4 CLASS="Argument">
<A NAME="pgfId=51518">
 </A>
Func</H4>
<P CLASS="Body">
<A NAME="pgfId=51519">
 </A>
A scalar string specifying the name of a user-supplied IDL function to be integrated. This function must accept a single scalar argument <I CLASS="Italic">
X</I>
 and return a scalar result. It must be defined over the closed interval [<I CLASS="Italic">
A, B</I>
].</P>
<P CLASS="Body">
<A NAME="pgfId=51520">
 </A>
For example, if we wish to integrate the cubic polynomial</P>
<P CLASS="Body---centered">
<A NAME="pgfId=51521">
 </A>
<EM CLASS="Emphasis">
y</EM>
 = <EM CLASS="Emphasis">
x</EM>
<SUP CLASS="Superscript">
3</SUP>
 + (<EM CLASS="Emphasis">
x</EM>
 - 1)<SUP CLASS="Superscript">
2</SUP>
 + 3</P>
<P CLASS="Body">
<A NAME="pgfId=51522">
 </A>
we define a function CUBIC to express this relationship in the IDL language:</P>
<P CLASS="Code-Indent">
<A NAME="pgfId=51523">
 </A>
FUNCTION cubic, X</P>
<P CLASS="Code-Indent">
<A NAME="pgfId=51524">
 </A>
&nbsp;&nbsp;RETURN, X^3 + (X - 1.0)^2 + 3.0</P>
<P CLASS="Code-Indent">
<A NAME="pgfId=51525">
 </A>
END</P>
</DIV>
<DIV>
<H4 CLASS="Argument">
<A NAME="pgfId=51526">
 </A>
A</H4>
<P CLASS="Body">
<A NAME="pgfId=51527">
 </A>
The lower limit of the integration. <I CLASS="Italic">
A</I>
 can be either a scalar or an array.</P>
</DIV>
<DIV>
<H4 CLASS="Argument">
<A NAME="pgfId=51528">
 </A>
B</H4>
<P CLASS="Body">
<A NAME="pgfId=51529">
 </A>
The upper limit of the integration. <I CLASS="Italic">
B</I>
 can be either a scalar or an array.</P>
<UL>
<P CLASS="Note"><b><FONT SIZE=+1>NOTE: </FONT></b>
<A NAME="pgfId=51530">
 </A>
If arrays are specified for <I CLASS="Italic">
A</I>
 and <I CLASS="Italic">
B</I>
, then QROMB integrates the user-supplied function over the interval [<I CLASS="Italic">
A</I>
<SUB CLASS="Subscript">
i</SUB>
, <I CLASS="Italic">
B</I>
<SUB CLASS="Subscript">
i</SUB>
] for each <I CLASS="Italic">
i</I>
. If either <I CLASS="Italic">
A</I>
 or <I CLASS="Italic">
B</I>
 is a scalar and the other an array, the scalar is paired with each array element in turn.</LI>
</UL>
</DIV>
</DIV>
<DIV>
<H3 CLASS="Heading-1R">
<A NAME="pgfId=51531">
 </A>
Keywords</H3>
<DIV>
<H4 CLASS="Argument">
<A NAME="pgfId=51533">
 </A>
<A NAME="marker=51532">
 </A>
DOUBLE </H4>
<P CLASS="Body">
<A NAME="pgfId=51534">
 </A>
Set this keyword to force the computation to be done in double-precision arithmetic.</P>
</DIV>
<DIV>
<H4 CLASS="Argument">
<A NAME="pgfId=51536">
 </A>
<A NAME="marker=51535">
 </A>
EPS</H4>
<P CLASS="Body">
<A NAME="pgfId=51537">
 </A>
The desired fractional accuracy. For single-precision calculations, the default value is 1.0&nbsp;<EM CLASS="Symbol">
&#165;</EM>
&nbsp;10<SUP CLASS="Superscript">
-6</SUP>
. For double-precision calculations, the default value is 1.0&nbsp;<EM CLASS="Symbol">
&#165;</EM>
&nbsp;10<SUP CLASS="Superscript">
-12</SUP>
.</P>
</DIV>
<DIV>
<H4 CLASS="Argument">
<A NAME="pgfId=51539">
 </A>
<A NAME="marker=51538">
 </A>
JMAX</H4>
<P CLASS="Body">
<A NAME="pgfId=51540">
 </A>
2<SUP CLASS="Superscript">
(JMAX - 1)</SUP>
 is the maximum allowed number of steps. If this keyword is not specified, a default of 20 is used. </P>
</DIV>
<DIV>
<H4 CLASS="Argument">
<A NAME="pgfId=51542">
 </A>
<A NAME="marker=51541">
 </A>
K</H4>
<P CLASS="Body">
<A NAME="pgfId=51543">
 </A>
Integration is performed by Romberg's method of order 2K. If not specified, the default is K=5. (K=2 is Simpson's rule).</P>
</DIV>
</DIV>
<DIV>
<H3 CLASS="Heading-1R">
<A NAME="pgfId=51544">
 </A>
Example</H3>
<P CLASS="Body">
<A NAME="pgfId=51545">
 </A>
To integrate the CUBIC function (listed above) over the interval [0, 3] and print the result:</P>
<P CLASS="Code">
<A NAME="pgfId=51546">
 </A>
PRINT, QROMB('cubic', 0.0, 3.0)</P>
<P CLASS="Body">
<A NAME="pgfId=51547">
 </A>
IDL prints:</P>
<P CLASS="Code-Result">
<A NAME="pgfId=51548">
 </A>
&nbsp;32.2500</P>
<P CLASS="Body">
<A NAME="pgfId=51549">
 </A>
This is the exact solution.</P>
</DIV>
<DIV>
<H3 CLASS="Heading-1R">
<A NAME="pgfId=51550">
 </A>
See Also</H3>
<P CLASS="Body">
<A NAME="pgfId=51566">
 </A>
<A HREF="idld4.htm#70083" CLASS="XRef">
INT_2D</A>
, <A HREF="idld5.htm#74581" CLASS="XRef">
INT_3D</A>
, <A HREF="idld6.htm#51833" CLASS="XRef">
INT_TABULATED</A>
, <A HREF="idl159.htm#31379" CLASS="XRef">
QROMO</A>
, <A HREF="idl15a.htm#21978" CLASS="XRef">
QSIMP</A>
</P>
</DIV>
</BODY>
</HTML>
