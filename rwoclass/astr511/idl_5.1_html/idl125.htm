<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML EXPERIMENTAL 970324//EN">
<HTML>
<STYLE><!--
H1         { font-family: Stone Sans, Helvetica, Arial, sans-serif }
H1.Chapter-Name    { font-size: 36pt }
H2         { font-family: Stone Sans, Helvetica, Arial, sans-serif }
H3         { font-family: Stone Sans, Helvetica, Arial, sans-serif }
H4         { font-family: Stone Sans, Helvetica, Arial, sans-serif }
H5         { font-family: Stone Sans, Helvetica, Arial, sans-serif ;
             margin-top: -5.0pt ; font-size: 12pt }
H6         { font-family: Stone Sans, Helvetica, Arial, sans-serif ;
             margin-top: -5.0pt ; font-size: 12pt }
P          { font-family: Minion, Times, serif }
P.api      { font-family: Courier ; font-weight: Bold }
P.Code     { font-family: Courier, serif ; font-size: 10pt}
P.Code-2   { font-family: Courier, serif ; font-size: 10pt}
P.Code-Result   { font-family: Courier, serif ; font-size: 10pt ;
                  font-weight: Bold}
P.ChapTOC  { font-family: Stone Sans, Helvetica, Arial, sans-serif }
P.Chapter-NameTOC   { font-family: Stone Sans, Helvetica, Arial, sans-serif ;
		      font-size: 20pt; font-weight: Bold }
P.Level2IX	{margin-left: 10pt }
LI.Code-Numbered     { font-family: Courier, serif ; font-size: 10pt}
LI.Code-Numbered-1   { font-family: Courier, serif ; font-size: 10pt}
--></STYLE>

<HEAD>
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter">

<TITLE> NEWTON</TITLE></HEAD>
<BODY BGCOLOR="#ffffff">
<DIV>
<DIV><table width="100%" border=0 cellspacing=0 cellpadding=0> <TR>  <TD></TD>   <TD  bgcolor="#ffffff">     <IMG SRC = "idlmap.gif" USEMAP = "#idlmap.gif" BORDER = 0>   </TD> </TR></TABLE><MAP NAME = "idlmap.gif"><AREA SHAPE=RECT HREF="idl126.htm" COORDS="290, 29, 344, 43"><AREA SHAPE=RECT HREF="idl.htm" COORDS="139, 29, 239, 46"><AREA SHAPE=RECT HREF="idl124.htm" COORDS="0, 29, 98, 46"><AREA SHAPE=RECT HREF="idl.htm" COORDS="68, 0, 275, 18"></MAP></DIV><HR></DIV>
<H2 CLASS="Routine-Name">
<A NAME="pgfId=889295">
 </A>
<A NAME="50918">
 </A>
NEWTON</H2>
<P CLASS="Body">
<A NAME="pgfId=889300">
 </A>
The <A NAME="marker=889298">
 </A>
NEWTON <A NAME="marker=889299">
 </A>
function solves a system of <I CLASS="Italics">
n</I>
 non-linear equations in <I CLASS="Italics">
n</I>
 dimensions using a globally-convergent <A NAME="marker=889301">
 </A>
Newton's method. The result is an <I CLASS="Italics">
n</I>
-element vector containing the solution.</P>
<P CLASS="Body">
<A NAME="pgfId=889302">
 </A>
NEWTON is based on the routine <CODE CLASS="Code">
newt</CODE>
 described in section 9.7 of <I CLASS="Italics">
Numerical Recipes in C: The Art of Scientific Computing</I>
 (Second Edition), published by Cambridge University Press, and is used by permission.</P>
<DIV>
<H3 CLASS="Heading-1R">
<A NAME="pgfId=889303">
 </A>
Calling Sequence</H3>
<P CLASS="Body">
<A NAME="pgfId=889304">
 </A>
Result = NEWTON(<I CLASS="Italics">
X, Vecfunc</I>
)</P>
</DIV>
<DIV>
<H3 CLASS="Heading-1R">
<A NAME="pgfId=889305">
 </A>
Arguments</H3>
<DIV>
<H4 CLASS="Argument">
<A NAME="pgfId=889306">
 </A>
X</H4>
<P CLASS="Body">
<A NAME="pgfId=889307">
 </A>
An <I CLASS="Italics">
n</I>
-element vector containing an initial guess at the solution of the system.</P>
</DIV>
<DIV>
<H4 CLASS="Argument">
<A NAME="pgfId=889308">
 </A>
Vecfunc</H4>
<P CLASS="Body">
<A NAME="pgfId=889309">
 </A>
A scalar string specifying the name of a user-supplied IDL function that defines the system of non-linear equations. This function must accept an <EM CLASS="Emphasis">
n</EM>
-element vector argument <I CLASS="Italics">
X</I>
 and return an <EM CLASS="Emphasis">
n</EM>
-element vector result.</P>
<P CLASS="Body">
<A NAME="pgfId=889310">
 </A>
For example, suppose the non-linear system is defined by the following equations:</P>
<P CLASS="Body---centered">
<A NAME="pgfId=889311">
 </A>
<EM CLASS="Emphasis">
y</EM>
<SUB CLASS="Subscript">
0</SUB>
 = <EM CLASS="Emphasis">
x</EM>
<SUB CLASS="Subscript">
0</SUB>
 + <EM CLASS="Emphasis">
x</EM>
<SUB CLASS="Subscript">
1</SUB>
 - 3,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<EM CLASS="Emphasis">
y</EM>
<SUB CLASS="Subscript">
1</SUB>
 = <EM CLASS="Emphasis">
x</EM>
<SUB CLASS="Subscript">
0</SUB>
<SUP CLASS="Superscript">
2</SUP>
 + <EM CLASS="Emphasis">
x</EM>
<SUB CLASS="Subscript">
1</SUB>
<SUP CLASS="Superscript">
2</SUP>
 - 9</P>
<P CLASS="Body">
<A NAME="pgfId=889312">
 </A>
We write a function NEWTFUNC to express these relationships in the IDL language:</P>
<P CLASS="Code-Indent">
<A NAME="pgfId=889313">
 </A>
FUNCTION newtfunc, X</P>
<P CLASS="Code-Indent">
<A NAME="pgfId=889314">
 </A>
&nbsp;&nbsp;RETURN, [X[0] + X[1] -3.0, X[0]^2 + X[1]^2 - 9.0]</P>
<P CLASS="Code-Indent">
<A NAME="pgfId=889315">
 </A>
END</P>
</DIV>
</DIV>
<DIV>
<H3 CLASS="Heading-1R">
<A NAME="pgfId=889316">
 </A>
Keywords</H3>
<DIV>
<H4 CLASS="Argument">
<A NAME="pgfId=889318">
 </A>
<A NAME="marker=889317">
 </A>
CHECK</H4>
<P CLASS="Body">
<A NAME="pgfId=889319">
 </A>
NEWTON calls an internal function named <CODE CLASS="Code">
fmin()</CODE>
 to determine whether the routine has converged to a local minimum rather than to a global minimum (see <I CLASS="Italics">
Numerical Recipes</I>
, section 9.7). Use the CHECK keyword to specify a named variable which will be set to 1 if the routine has converged to a local minimum or to 0 if it has not. If the routine does converge to a local minimum, try restarting from a different initial guess to obtain the global minimum.</P>
</DIV>
<DIV>
<H4 CLASS="Argument">
<A NAME="pgfId=889321">
 </A>
<A NAME="marker=889320">
 </A>
DOUBLE</H4>
<P CLASS="Body">
<A NAME="pgfId=889322">
 </A>
Set this keyword to force the computation to be done in double-precision arithmetic.</P>
</DIV>
<DIV>
<H4 CLASS="Argument">
<A NAME="pgfId=889324">
 </A>
<A NAME="marker=889323">
 </A>
ITMAX</H4>
<P CLASS="Body">
<A NAME="pgfId=889325">
 </A>
The maximum allowed number of iterations. The default value is 200. </P>
</DIV>
<DIV>
<H4 CLASS="Argument">
<A NAME="pgfId=889327">
 </A>
<A NAME="marker=889326">
 </A>
STEPMAX</H4>
<P CLASS="Body">
<A NAME="pgfId=889328">
 </A>
The scaled maximum step length allowed in line search. The default value is 100.0.</P>
</DIV>
<DIV>
<H4 CLASS="Argument">
<A NAME="pgfId=889330">
 </A>
<A NAME="marker=889329">
 </A>
TOLF</H4>
<P CLASS="Body">
<A NAME="pgfId=889332">
 </A>
Set the <A NAME="marker=889331">
 </A>
convergence criterion on the function values. The default value is 1.0&nbsp;<EM CLASS="MathSymbol">
&#165;</EM>
&nbsp;10<SUP CLASS="Superscript">
-4</SUP>
.</P>
</DIV>
<DIV>
<H4 CLASS="Argument">
<A NAME="pgfId=889334">
 </A>
<A NAME="marker=889333">
 </A>
TOLMIN</H4>
<P CLASS="Body">
<A NAME="pgfId=889335">
 </A>
Set the criterion for deciding whether spurious convergence to a minimum of the function <CODE CLASS="Code">
fmin()</CODE>
 has occurred. The default value is 1.0&nbsp;<EM CLASS="MathSymbol">
&#165;</EM>
&nbsp;10<SUP CLASS="Superscript">
-6</SUP>
.</P>
</DIV>
<DIV>
<H4 CLASS="Argument">
<A NAME="pgfId=889337">
 </A>
<A NAME="marker=889336">
 </A>
TOLX</H4>
<P CLASS="Body">
<A NAME="pgfId=889338">
 </A>
Set the convergence criterion on <I CLASS="Italics">
X</I>
. The default value is 1.0&nbsp;<EM CLASS="MathSymbol">
&#165;</EM>
&nbsp;10<SUP CLASS="Superscript">
-7</SUP>
.</P>
</DIV>
</DIV>
<DIV>
<H3 CLASS="Heading-1R">
<A NAME="pgfId=889339">
 </A>
Example</H3>
<P CLASS="Body">
<A NAME="pgfId=889340">
 </A>
Use NEWTON to solve an n-dimensional system of n non-linear equations. Systems of non-linear equations may have multiple solutions; starting the algorithms with different initial guesses enables detection of different solutions.</P>
<P CLASS="Code">
<A NAME="pgfId=889341">
 </A>
X = [1.0, 5.0]	<EM CLASS="Comment">;
Provide an initial guess as the algorithm's starting point.</EM>
</P>
<P CLASS="Code">
<A NAME="pgfId=889342">
 </A>
result = NEWTON(X, 'newtfunc')	<EM CLASS="Comment">;
Compute the solution.</EM>
</P>
<P CLASS="Code">
<A NAME="pgfId=889343">
 </A>
PRINT, result	<EM CLASS="Comment">;
Print the result.</EM>
</P>
<P CLASS="Body">
<A NAME="pgfId=889344">
 </A>
IDL prints:</P>
<P CLASS="Code-Result">
<A NAME="pgfId=889345">
 </A>
&nbsp;-0.000346127 3.00000</P>
<P CLASS="Code">
<A NAME="pgfId=889346">
 </A>
X = [1.0, -1.0]	<EM CLASS="Comment">;
Try a different starting point.</EM>
</P>
<P CLASS="Code">
<A NAME="pgfId=889347">
 </A>
result = NEWTON(X,'newtfunc')	<EM CLASS="Comment">;
Compute the solution</EM>
.</P>
<P CLASS="Code">
<A NAME="pgfId=889348">
 </A>
PRINT, result	<EM CLASS="Comment">;
Print the result.</EM>
</P>
<P CLASS="Body">
<A NAME="pgfId=889349">
 </A>
IDL prints:</P>
<P CLASS="Code-Result">
<A NAME="pgfId=889350">
 </A>
&nbsp;&nbsp;2.99999 8.37117e-05</P>
</DIV>
<DIV>
<H3 CLASS="Heading-1R">
<A NAME="pgfId=889351">
 </A>
See Also</H3>
<P CLASS="Body">
<A NAME="pgfId=889361">
 </A>
<A HREF="idl1c.htm#62043" CLASS="XRef">
BROYDEN</A>
, <A HREF="idlaf.htm#97846" CLASS="XRef">
FX_ROOT</A>
, <A HREF="idlb0.htm#61728" CLASS="XRef">
FZ_ROOTS</A>
</P>
</DIV>
</BODY>
</HTML>
